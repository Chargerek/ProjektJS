<%- include('partials/header', { title: 'Użytkownicy - Social App', activeTab: 'users' }) %>

<div class="container">
    <div class="page-header">
        <h2>Użytkownicy</h2>
        
        <!-- Filtry i sortowanie -->
        <form method="GET" action="/users" class="filters-form">
            <div class="filters-row">
                <input 
                    type="text" 
                    name="search" 
                    placeholder="Szukaj użytkowników..." 
                    value="<%= filters.search %>"
                    class="filter-input"
                >
                <select name="sort" class="filter-select">
                    <option value="id:asc" <%= filters.sort === 'id:asc' ? 'selected' : '' %>>ID (rosnąco)</option>
                    <option value="id:desc" <%= filters.sort === 'id:desc' ? 'selected' : '' %>>ID (malejąco)</option>
                    <option value="username:asc" <%= filters.sort === 'username:asc' ? 'selected' : '' %>>Username (A-Z)</option>
                    <option value="username:desc" <%= filters.sort === 'username:desc' ? 'selected' : '' %>>Username (Z-A)</option>
                    <option value="following:desc" <%= filters.sort === 'following:desc' ? 'selected' : '' %>>Najwięcej obserwowanych</option>
                    <option value="following:asc" <%= filters.sort === 'following:asc' ? 'selected' : '' %>>Najmniej obserwowanych</option>
                </select>
                <button type="submit" class="btn btn-primary">Filtruj</button>
                <a href="/users" class="btn btn-secondary">Wyczyść</a>
            </div>
        </form>
    </div>

    <!-- Lista użytkowników -->
    <div class="users-grid">
        <% if (users.length === 0) { %>
            <div class="empty-state">Brak użytkowników do wyświetlenia</div>
        <% } else { %>
            <% users.forEach(user => { %>
                <div class="user-card">
                    <div class="user-avatar">
                        <%= (user.displayName || user.username || 'U')[0].toUpperCase() %>
                    </div>
                    <div class="user-info">
                        <h3><%= user.displayName || user.username %></h3>
                        <p class="username">@<%= user.username %></p>
                        <% if (user.following) { %>
                            <p class="following">Obserwuje: <%= user.following.length %></p>
                        <% } %>
                    </div>
                </div>
            <% }); %>
        <% } %>
    </div>

    <!-- Paginacja -->
    <% if (pagination.totalPages > 1) { %>
        <div class="pagination">
            <% if (pagination.hasPrev) { %>
                <a href="?page=<%= pagination.page - 1 %><%= filters.search ? '&search=' + filters.search : '' %><%= filters.sort ? '&sort=' + filters.sort : '' %>" class="pagination-btn">← Poprzednia</a>
            <% } %>
            <span class="pagination-info">
                Strona <%= pagination.page %> z <%= pagination.totalPages %> (<%= pagination.total %> użytkowników)
            </span>
            <% if (pagination.hasNext) { %>
                <a href="?page=<%= pagination.page + 1 %><%= filters.search ? '&search=' + filters.search : '' %><%= filters.sort ? '&sort=' + filters.sort : '' %>" class="pagination-btn">Następna →</a>
            <% } %>
        </div>
    <% } %>
</div>

<%- include('partials/footer') %>

